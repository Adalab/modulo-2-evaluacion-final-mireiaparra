"use strict";const allList=document.querySelector(".js-allCharactersList"),favList=document.querySelector(".js-favCharactersList"),favSection=document.querySelector(".js-favSection"),searchBtn=document.querySelector(".js-searchBtn"),searchInput=document.querySelector(".js-searchInput"),container=document.querySelector(".js-main");function handleClickSearch(e){e.preventDefault;const a=characters.filter(e=>e.name.toLowerCase().includes(searchInput.value.toLowerCase())),t=characters.filter(e=>e.status.toLowerCase().includes(searchInput.value.toLowerCase()));let c=a.concat(t);allList.innerHTML="",paintCharacters(c,allList,"characters__back");const s=allList.children;document.querySelector(".fav");for(let e=0;e<s.length;e++){s[e].addEventListener("click",handleClickFav);const a=s[e].firstChild;if(console.log(a),null!==favCharacters&&favCharacters!==[]){const e=favCharacters.findIndex(e=>e.char_id==parseInt(a.id));console.log(e),-1!==e?a.classList.add("allFavs"):a.classList.add("characters__back")}}}searchBtn.addEventListener("click",handleClickSearch);let favCharacters=[];function paintFav(e){let a=e.target.parentElement;a.classList.add("allFavs");const t=characters.find(e=>e.char_id==parseInt(a.id)),c=favCharacters.findIndex(e=>e.char_id==parseInt(a.id));-1===c?favCharacters.push(t):(favCharacters.splice(c,1),a.classList.remove("allFavs")),updateFavList()}function updateFavList(){favList.innerHTML="",console.log(favCharacters,"Estoy aquÃ­"),0===favCharacters.length||null===favCharacters?(favSection.classList.add("hidden"),container.classList.remove("main"),removeLocalSt(),console.log("Esto es el if")):(favSection.classList.remove("hidden"),paintCharacters(favCharacters,favList,"favsCharacters__list--article"),console.log(favCharacters.length),styleFav(),setLocalSt(),console.log("Esto es el else"))}function styleFav(){container.classList.add("main");const e=document.querySelectorAll(".favsCharacters__list--article");for(const a of e){const e=document.createElement("p");e.classList.add("removeFav"),e.addEventListener("click",handleClickRemove);const t=document.createTextNode("X");e.appendChild(t),a.appendChild(e)}}function handleClickRemove(e){e.preventDefault;const a=favCharacters.findIndex(a=>a.char_id==parseInt(e.target.parentElement.id));favCharacters.splice(a,1);const t=allList.children;Array.prototype.slice.call(t).find(a=>a.firstChild.id==parseInt(e.target.parentElement.id)).firstChild.classList.remove("allFavs"),updateFavList()}function handleClickFav(e){e.preventDefault,paintFav(e)}createReset();let favsLocal=JSON.parse(localStorage.getItem("favChars"));function setLocalSt(){localStorage.setItem("favChars",JSON.stringify(favCharacters))}function removeLocalSt(){localStorage.removeItem("favChars")}function paintLocalSt(){if(null!==favsLocal&&favsLocal!==[]){favSection.classList.remove("hidden"),favCharacters=favsLocal,paintCharacters(favsLocal,favList,"favsCharacters__list--article"),styleFav();const e=allList.children;for(let a=0;a<e.length;a++){const t=e[a].firstChild;console.log(t);-1!==favCharacters.findIndex(e=>e.char_id==parseInt(t.id))&&t.classList.add("allFavs")}}}function createReset(){const e=document.createElement("button"),a=document.createTextNode("Delete All");e.appendChild(a),e.classList.add("resetBtn"),favSection.appendChild(e),e.addEventListener("click",handleClickReset)}function handleClickReset(){favCharacters=[],favList.innerHTML="",favSection.classList.add("hidden"),container.classList.remove("main"),removeLocalSt();for(const e of allList.children)e.firstChild.classList.remove("allFavs")}let characters=[];function paintCharacters(e,a,t){for(let c=0;c<e.length;c++){const s=document.createElement("li"),n=document.createElement("article");n.classList.add(t),n.setAttribute("id",""+e[c].char_id);const l=document.createElement("img");n.appendChild(l);const r=document.createElement("h2");n.appendChild(r);const i=document.createElement("p");n.appendChild(i),s.appendChild(n),a.appendChild(s);const o=document.createTextNode(""+e[c].name);r.appendChild(o),l.src=""+e[c].img,l.alt="Photo of "+e[c].name,l.style.height="150px",l.style.width="110px";const d=document.createTextNode(""+e[c].status);i.appendChild(d)}}function getCharacters(){fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{characters=e,paintCharacters(e,allList,"allCharacters__list--article");const a=allList.children;for(let e=0;e<a.length;e++)a[e].addEventListener("click",handleClickFav);paintLocalSt()})}getCharacters();